#Setup Game
info.player1.set_score(0)
info.player1.set_life(3)
#Create Character
running_man_right = img("""
    . . . . . . . . . . . . . . . .
    . . . f f f f f f . . . . . . .
    . . f 1 1 1 1 1 1 f . . . . . .
    . b f 1 1 f 1 f 1 f b . . . . .
    b . f 1 1 f 1 f 1 f . b . . . .
    b . f 1 1 1 1 1 1 f . b . . . .
    . b b f f f f f f . . b . . . .
    b b b f 2 2 2 2 f . f b f f f .
    b b b f 2 2 2 2 f f c c c c c f
    c c c f 2 2 2 2 f f c f f f f .
    . c c f 2 2 2 2 f f c f . . . .
    . . c f f f f f f . f . . . . .
    . . . f . . . . f . . . . . . .
    . . . f . . . . f . . . . . . .
    . . . f . . . . f . . . . . . .
    . . . f . . . . f . . . . . . .
""")
running_man_left = img("""
    . . . . . . . . . . . . . . . .
    . . . f f f f f f . . . . . . .
    . . f 1 1 1 1 1 1 f . . . . . .
    . b f 1 1 f 1 f 1 f b . . . . .
    b . f 1 1 f 1 f 1 f . b . . . .
    b . f 1 1 1 1 1 1 f . b . . . .
    . b b f f f f f f . . b . . . .
    b b b f 8 8 8 8 f . f b f f f .
    b b b f 8 8 8 8 f f c c c c c f
    c c c f 8 8 8 8 f f c f f f f .
    . c c f 8 8 8 8 f f c f . . . .
    . . c f f f f f f . f . . . . .
    . . . f . . . . f . . . . . . .
    . . . f . . . . f . . . . . . .
    . . . f . . . . f . . . . . . .
    . . . f . . . . f . . . . . . .
""")
running_man = sprites.create(running_man_right,
SpriteKind.player)
running_man.ay = 200
scene.camera_follow_sprite(running_man)
animation.run_image_animation(running_man, [])

def face_right():
    running_man.set_image(running_man_right)
controller.player1.on_button_event(ControllerButton.RIGHT, ControllerButtonEvent.PRESSED, face_right)

def face_left():
    running_man.set_image(running_man_left)
controller.player1.on_button_event(ControllerButton.LEFT, ControllerButtonEvent.PRESSED, face_left)

#create tileset
tiles.set_tilemap(tilemap("""level"""))
scene.set_background_color(6)
#create gravity and jump
canDoublejump = True
controller.move_sprite(running_man ,50, 0) 
def on_jump():
   global canDoublejump
   if running_man.is_hitting_tile(CollisionDirection.BOTTOM) or canDoublejump:
       running_man.vy = -100
       canDoublejump = running_man.is_hitting_tile(CollisionDirection.BOTTOM)
controller.player1.on_button_event(ControllerButton.A,ControllerButtonEvent.PRESSED,on_jump)
#Create enemies
puff = sprites.create(img("""
    . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . .
    . . . . . 4 4 4 4 4 . . . . . .
    . . . . 4 4 4 4 4 4 4 . . . . .
    . . . . 4 1 4 4 4 1 4 . . . . .
    . . . . 4 f 1 4 f 1 4 . . . . .
    . . . . 4 f 1 4 f 1 4 . . . . .
    . . . . 4 4 4 4 4 4 4 . . . . .
    . . . . 2 4 4 4 4 4 2 2 . . . .
    . . . 2 2 2 . . . 2 2 2 . . . .
    . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . .
    . . . . . . . . . . . . . . . .
"""),
SpriteKind.enemy)
puff.ay = 200
tiles.place_on_tile(puff, tiles.get_tile_location(10, 13))
tiles.place_on_tile(puff, tiles.get_tile_location(17, 12))
tiles.place_on_tile(puff, tiles.get_tile_location(33, 11))
boss_puff = sprites.create(img("""
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ..........................4444444444444.........................
    ........................44444444444444444.......................
    ......................444444444444444444444.....................
    ....................4444444444444444444444444...................
    ...................444444444444444444444444444..................
    ..................44444444444444444444444444444.................
    .................4444444444444444444444444444444................
    ................444444444444444444444444444444444...............
    ...............44444444444444444444444444444444444..............
    ...............44444444444444444444444444444444444..............
    ..............4444444444444444444444444444444444444.............
    ..............4444444444444444444444444444444444444.............
    .............444444144444444444444444441444444444444............
    .............444444114444444444444444411444444444444............
    ............44444441114444444444444441114444444444444...........
    ............4444444ff11444444444444411114444444444444...........
    ............4444444fff1144444444444f11114444444444444...........
    ............4444444fff111444444444ff11114444444444444...........
    ............4444444fff11114444444fff11114444444444444...........
    ............4444444fff11114444444fff11114444444444444...........
    ............4444444fff11114444444fff11114444444444444...........
    ............4444444fff11114444444fff11114444444444444...........
    ............4444444fff11114444444fff11114444444444444...........
    ............4444444ff111114444444ff111114444444444444...........
    ............44444441111111444444411111114444444444444...........
    ............44444444111114444444441111144444444444444...........
    ............44444444444444444444444444444444444444444...........
    .............4444444444444444444444444444444444444444...........
    .............444444444444444444444444444444444444444............
    ..............4444444444444444444444444444444444444.............
    ..............44444444444fffffffffff444444444444444.............
    ...............44444444444444444444444444444444444..............
    ...............44444444444444444444444444444444444..............
    ................444444444444444444444444444444444...............
    ................24444444444444444444444444444444................
    ................224444444444444444444444444222222...............
    ..............222224444444444444444444444222222222..............
    .............2222222444444444444444444442222222222..............
    ............222222222244444444444444444222222222222.............
    ...........2222222222222444444444444442222222222222.............
    ..........22222222222222224444444444422222222222222.............
    ..........2222222222222222..........222222222222222.............
    ..........2222222222222222.........2222222222222222.............
    .........22222222222222222.........2222222222222222.............
    .........2222222222222222.........22222222222222222.............
    .........2222222222222222.........22222222222222222.............
    .........2222222222222222.........2222222222222222..............
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
"""))
boss_puff.ay = 200
def on_overlap2(sprite, otherSprite):
    puff.destroy()
    info.change_life_by(-1)
sprites.on_overlap(SpriteKind.player, SpriteKind.enemy, on_overlap2)
#Create projectiles
def on_event_pressed():
    bb = sprites.create_projectile_from_sprite(img("""
        . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . .
        . . . . . . . b b b . . . . . .
        . . . . . . b b b b b . . . . .
        . . . . . . b b b b b . . . . .
        . . . . . . b b b b b . . . . .
        . . . . . . . b b b . . . . . .
        . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . .
        . . . . . . . . . . . . . . . .
    """), running_man, 50, 0)
controller.B.on_event(ControllerButtonEvent.PRESSED, on_event_pressed)

# def on_button_event_b_pressed():
#     bb = sprites.create(img("""
#         . . . . . . . . . . . . . . . .
#         . . . . . . . . . . . . . . . .
#         . . . . . . . . . . . . . . . .
#         . . . . . . . . . . . . . . . .
#         . . . . . . . . . . . . . . . .
#         . . . . . . . b b b . . . . . .
#         . . . . . . b b b b b . . . . .
#         . . . . . . b b b b b . . . . .
#         . . . . . . b b b b b . . . . .
#         . . . . . . . b b b . . . . . .
#         . . . . . . . . . . . . . . . .
#         . . . . . . . . . . . . . . . .
#         . . . . . . . . . . . . . . . .
#         . . . . . . . . . . . . . . . .
#         . . . . . . . . . . . . . . . .
#         . . . . . . . . . . . . . . . .
#     """),SpriteKind.projectile)
# controller.B.on_event(ControllerButtonEvent.PRESSED, on_button_event_b_pressed)

#Create goal
goal = sprites.create(img("""
    . . . 2 4 1 . .
    . . 2 4 4 1 . .
    . 2 4 4 4 1 . .
    2 4 4 4 4 1 . .
    . 4 4 4 4 1 . .
    . . 4 4 4 1 . .
    . . . 4 4 1 . .
    . . . . b 1 . .
    . . . . b 1 . .
    . . . . b 1 . .
    . . . . b 1 . .
    . . . . b 1 . .
    . . . . b 1 . .
    . . . . b 1 . .
    . . . . b 1 . .
    . . . . b 1 . .
    . . . . b 1 . .
    . . . . b 1 . .
    . . . 4 5 5 5 .
    . . 4 5 5 5 5 5
"""),
SpriteKind.player)
tiles.place_on_tile(goal, tiles.get_tile_location(48, 12))
def on_overlap(sprite, otherSprite):
    game.over()
sprites.on_overlap(SpriteKind.player, SpriteKind.player, on_overlap)
#Create music
music.play_melody("E E E Eb E E C C", 300)
music.play_melody("B B B B", 150)
music.play_melody("Ab A Ab A Ab A Ab A", 300)
music.play_melody("E E E Eb E E C C", 300)
music.play_melody("B B B B", 150)
music.play_melody("Ab A Ab A - Bb A", 300)
